### 浏览器

#### 浏览器几大基础结构

尽管当今的互联网，各路浏览器都在大显身手，但是基本的结构还是由以下几部分组成

- [x] 地址栏：用于输入网站地址，通过识别地址信息跳转到对应网站
- [x] 菜单栏：包含设置内容和常用快捷操作，用户可自定义设置内容
- [x] 标签栏：包含一个或多个窗口，窗口的内容互不干扰，独立运行
- [x] 窗口栏：显示当前网站地址的访问内容，可为用户提供各种交互操作
- [x] 状态栏：用于实时显示当前操作和下载 Web 页面的进度情况

#### 浏览器历史

- 1993 年，NCSA 组织发布了 Mosaic 浏览器
- 1994 年，网景公司发布了 Navigator 浏览器
- 1995 年，微软公司发布了 IE 浏览器，并开始了浏览器之战
- 1996 年，Navigator 浏览器的市场份额达到 86%，微软公司开始将 IExplorer 浏览器整合到 Windows 操作系统中
- 1996 年，ASA 公司发布了 Opera 浏览器
- 1998 年，网景公司启动其开源产品，推出 Mozilla
- 2001 年，为人诟病的 IE6 发布，霸占国内市场十多年
- 2002 年，网景公司发布了 Firefox 浏览器(网景公司挺厉害的啊)
- 2003 年，苹果公司发布了 Safari 浏览器
- 2004 年，IE 浏览器的市场份额达到巅峰 92%，自此以后其市场份额开始下滑
- 2006 年，Firefox 3 的发布创下了吉尼斯世界纪录，一天 800 万下载量
- 2008 年，谷歌公司发布了 Chrome 浏览器

世界五大浏览器：Chrome、Safari、Firefox、Opera、IE/Edge(似乎 IE 萎了)

#### 渲染引擎

`渲染引擎`又名`浏览器内核`，指负责对网页语法解析并渲染成一张`可视化页面`的解析器。它是浏览器最核心最重要的部位。因为不同浏览器具有不同的内核，所以对同一网页语法在不同内核的浏览器中的渲染效果是不同的，这就是常说的`浏览器差异性`

#### 5 大浏览器使用的渲染引擎(内核)

- [x] Chrome: Webkit(前期)、Blink(后期) Blink 说到底还是逃不过 Webkit 的影子
- [x] Apple Safari: Webkit
- [x] Mozilla Firefox: Gecko
- [x] ASA Opera: Presto(前期)、Blink(后期)
- [x] Microsoft IExplorer: Trident
- [x] Microsoft Edge: Trident(前期)、Blink(后期) 说明这个 Edge 也开始趋于谷歌化了

(注意一个问题：其实现在在市场上已经几乎没份额留给 IE 了，所以不用考虑兼容 IE 的浏览器)

#### 浏览器页面关键渲染步骤

要了解浏览器页面的渲染过程，首先得知道关键渲染路径。
`关键渲染路径`指：

1. 浏览器从最初接收请求到 HTML、CSS、JS 等资源
2. 然后解析、构建、渲染、布局、绘制、合成
3. 最后呈现在用户眼前界面的整个过程

页面渲染过程分为下面几个部分：
(感觉还应该有图片来辅助网页渲染过程)

- 解析文件
  - 将网络请求得来的`html文件`转换为 DOM 树
  - 将网络请求得来的`css文件`转换为 CSSOM 树
  - 将 DOM 树和 CSSOM 树合并生成渲染树
- 绘制图层
  - 根据`渲染树`生成`布局渲染树`(回流)
  - 根据`布局渲染树`生成`绘制渲染树`(重绘)
- 合成图层： 根据绘制渲染合成图层显示在屏幕上

##### 页面渲染关键步骤具体内容

- 解析文件
  HTML 文档描述一个页面的结构，浏览器通过`html解析器`将 HTML 解析成 DOM 结构。HTML 文档中所有内容皆为节点(文本内容、标签内容?)，各节点间拥有层级关系，彼此相连，构成 DOM 树
  CSS 文档描述一个页面的表现，浏览器通过 CSS 解析器将 CSS 解析成 CSSOM 树结构，与 DOM 树结构比较像。CSS 文档中所有内容皆为节点，与 HTML 文档中的节点一一对应，各节点间拥有层级关系，彼此相连，构成 CSSOM 树
  注意：在构建 DOM 树的过程中，当`HTML解析器`遇到`<script>`时会立即阻塞 DOM 树的构建，将控制权移交到浏览器的`JS引擎`等到 JS 引擎运行完毕，浏览器才会从中断的地方恢复 DOM 树的构建。`<script>`的脚本加载完成后，JS 引擎通过 DOM API 和 CSSOM API 操作 DOM 树和 CSSOM 树。为何会产生渲染阻塞呢？其根本原因在于：JS 操作 DOM 后，浏览器无法预测未来 DOM 的具体内容，为了防止无效操作和节省资源，只能阻塞 DOM 树的构建。

  DOM 树、CSSOM 树和渲染树三者的构建并无先后条件和先后顺序，并非完全独立而是会有交叉并行构建的情况。因此会形成一边加载，一边解析，一边渲染的工作现象

- 绘制图层
  进入绘制阶段，遍历渲染树，调用渲染器的 paint()在屏幕上绘制内容。根据渲染树布局计算样式，即每个节点在页面中的布局、尺寸等几何属性。HTML 默认是流式布局(什么是流式布局)，CSS 和 JS 会打破这种布局，改变 DOM 的几何属性和外观属性。
  在绘制过程中，根据渲染树布局，再根据布局绘制，这就是常说的 回流重绘

  回流、重绘

  - 回流：几何属性需改变的渲染
  - 重绘：更改外观属性而不影响几何属性的渲染

  注意：回流必定引发重绘，重绘不一定引发回流

- 合成图层
  将回流重绘生成的图层逐张合并并显示在屏幕上(这里的逐张合并 和 z-index 或者说浮动 这些是否有关系呢？)
  实际上，CSS 和 JS 往往会多次修改 DOM 或 CSSOM，简单来说就是用户的交互操作引发了网页的重渲染

#### 处理浏览器兼容性问题(CSS 篇)

1. 对其默认样式初始化：

```
选择 *通配符 会有执行性能问题
* {
  margin: 0;
  padding: 0;
}
```
